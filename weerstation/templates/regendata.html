<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regenmetingen per Uur</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Regenmetingen per Uur</h1>

    <!-- Dropdown-menu voor specifieke dagen -->
    <label for="daySelector">Selecteer een dag:</label>
    <select id="daySelector">
        <!-- Dynamisch te vullen met beschikbare dagen -->
    </select>

    <canvas id="regenGrafiek" width="400" height="200"></canvas>

    <script>
        // Data vanuit Django
        dataPerDag = {{ data_per_dag|safe }}; // Gegevens van de view

        // Vul de dropdown met beschikbare dagen
        const daySelector = document.getElementById('daySelector');
        Object.keys(dataPerDag).forEach(dag => {
            const option = document.createElement('option');
            option.value = dag;
            option.textContent = dag;
            daySelector.appendChild(option);
        });

        // Functie om data voor een geselecteerde dag op te halen
        function getDataForDay(day) {
            const uren = Array.from({ length: 24 }, (_, i) => `${i}:00`);
            const regenData = dataPerDag[day] || [];
            return { labels: uren, data: regenData };
        }

        // Initialisatie van de grafiek
        const ctx = document.getElementById('regenGrafiek').getContext('2d');
        let regenGrafiek = new Chart(ctx, {
            type: 'bar', // Staafdiagram
            data: {
                labels: [], // Urenlabels (dynamisch gevuld)
                datasets: [{
                    label: 'Regenval per Uur (mm)',
                    data: [], // Regenval per uur (dynamisch gevuld)
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                }]
            },
            options: {
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Uur'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Regenval (mm)'
                        },
                        beginAtZero: true
                    }
                }
            }
        });

        // Bij wijziging van de geselecteerde dag
        daySelector.addEventListener('change', (event) => {
            const geselecteerdeDag = event.target.value;
            const data = getDataForDay(geselecteerdeDag);

            // Update de grafiek
            regenGrafiek.data.labels = data.labels;
            regenGrafiek.data.datasets[0].data = data.data;
            regenGrafiek.update();
        });

        // Stel de standaarddag in bij het laden
        const eersteDag = Object.keys(dataPerDag)[0];
        if (eersteDag) {
            daySelector.value = eersteDag;
            const startData = getDataForDay(eersteDag);
            regenGrafiek.data.labels = startData.labels;
            regenGrafiek.data.datasets[0].data = startData.data;
            regenGrafiek.update();
        }
    </script>
</body>
</html>
